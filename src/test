working solution without visibility check

